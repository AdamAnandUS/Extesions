(()=>{"use strict";var e,t;!function(e){e[e.NULL=1]="NULL",e[e.INIT=2]="INIT",e[e.CONNECTING=3]="CONNECTING",e[e.LOGINING=4]="LOGINING",e[e.CHECKING=5]="CHECKING",e[e.PROXYING=6]="PROXYING",e[e.RUNNING=7]="RUNNING",e[e.INIT_CONNECT_ERROR=8]="INIT_CONNECT_ERROR",e[e.INIT_CONFIG_ERROR=9]="INIT_CONFIG_ERROR",e[e.NEED_LOGIN_ERROR=10]="NEED_LOGIN_ERROR",e[e.CHECKING_HOME_ERROR=11]="CHECKING_HOME_ERROR",e[e.EXPIRE_HOME_ERROR=12]="EXPIRE_HOME_ERROR",e[e.SERVER_INTERNAL_ERROR=13]="SERVER_INTERNAL_ERROR",e[e.PROXY_CONFLICT_ERROR=14]="PROXY_CONFLICT_ERROR",e[e.PROXY_BANNED_ERROR=15]="PROXY_BANNED_ERROR"}(e||(e={})),function(e){e.NOT_CONTROLLABLE="not_controllable",e.OTHER_EXTENSION="controlled_by_other_extensions",e.AVAILABLE="controllable_by_this_extension",e.CONTROLLING="controlled_by_this_extension"}(t||(t={}));const s="debug"==localStorage.mode,a=chrome,n=(a.webRequest.onBeforeRequest,a.runtime),i=(a.browserAction,a.proxy.settings,a.i18n.getMessage);a.tabs,a.windows,a.notifications,n.getManifest().version,i("@@extension_id");const o=s?(...e)=>(e.unshift("["+(new Date).toLocaleTimeString()+"] "),console.log.apply(console,e),e[1]):()=>{};let r=!1,c=!1;n.onInstalled.addListener((e=>{"install"==e.reason&&(r=!0,c=!0)}));const l=function(e){"string"==typeof e&&(this.value=Array.prototype.slice.call(document.querySelectorAll(e))),"object"==typeof e&&(this.value=[e])};l.prototype={eq:function(e){return this.value=[this.value[e]],this},each:function(e){return[].forEach.call(this.value,e),this},css:function(e){return this.each((function(t){t.style.cssText=t.style.cssText+e}))},cssdom:function(e){return this.each((function(t){for(var s in e)t.style[s]=e[s]}))},attr:function(e,t){return this.each((function(s){s.setAttribute(e,t)}))},getAttr:function(e){return this.value[0].getAttribute(e)},removeAttr:function(e){return this.each((function(t){t.removeAttribute(e)}))},animate:function(e,t,s,a,n,i,o,r,c,l){return this.each((function(d){d.style.cssText=d.style.cssText+"transition: all "+e+"s ease-in-out; transform: scale("+t+") rotate("+s+"deg) rotateX("+a+"deg) rotateY("+n+"deg) translate("+i+"px, "+o+"px) skew("+r+"deg, "+c+"deg); opacity:"+l+";"}))},on:function(e,t){return this.each((function(s){s.addEventListener(e,t,!1)}))},addClass:function(e){var t=e.split(" ");return this.each((function(e){for(var s=0;s<t.length;s++)e.classList?e.classList.add(t[s]):e.className+=" "+t[s]}))},toggleClass:function(e){var t=e.split(" ");return this.each((function(e){for(var s=0;s<t.length;s++)e.classList?e.classList.toggle(t[s]):new RegExp("\\b"+t[s]+"\\b").test(e.className)?e.className=e.className.replace(new RegExp("\\b"+t[s]+"\\b","g"),""):e.className+=" "+t[s]}))},removeClass:function(e){var t=e.split(" ");return this.each((function(e){for(var s=0;s<t.length;s++)e.classList?e.classList.remove(t[s]):e.className=e.className.replace(new RegExp("\\b"+t[s]+"\\b","g"),"")}))},html:function(e){return void 0===e?this.value[0].innerHTML:this.each((function(t){t.innerHTML=e}))},text:function(e){return void 0===e?this.value[0].innerText||this.value[0].textContent:this.each((function(t){t.innerText=e,t.textContent=e}))},insertBefore:function(e){return this.each((function(t){t.insertAdjacentHTML("beforeBegin",e)}))},insertAfter:function(e){return this.each((function(t){t.insertAdjacentHTML("afterEnd",e)}))},insertFirst:function(e){return this.each((function(t){t.insertAdjacentHTML("afterBegin",e)}))},insertLast:function(e){return this.each((function(t){t.insertAdjacentHTML("beforeEnd",e)}))},replaceChild:function(e,t){return console.log(this.value[0].parentNode),this.each((function(s){s.parentNode.replaceChild(e,t)}))},empty:function(){return this.each((function(e){e.innerHTML=""}))},parent:function(){return d(this.value[0].parentNode)},children:function(){return this.value=Array.prototype.filter.call(this.value[0].childNodes,(e=>e.nodeType<2)),this},first:function(){return d(this.value[0].children[0])},last:function(){return d(this.value[0].children[this.value[0].children.length-1])},prev:function(){return d(this.value[0].previousSibling.previousSibling)},siblings:function(){return this.value=Array.prototype.filter.call(this.value[0].parentNode.children,(e=>e!==this.value[0])),this},next:function(){return d(this.value[0].nextSibling.nextSibling)},get:function(){return this.value[0]},offset:function(){return this.each((function(e){offset=e.getBoundingClientRect()}))},log:function(){console.log(this)}};const d=function(e){return new l(e)};(e=>{function t(){let e=document.createElement("template");return e.innerHTML='<svg t="1624679465517" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2471" width="16" height="16"><path d="M319.338667 274.453333l64 0.448-3.541334 491.050667-64-0.469333zM908.010667 188.352a32 32 0 0 1 42.432 47.786667l-2.453334 2.176-106.666666 85.333333a32 32 0 0 1-42.432-47.786667l2.453333-2.176 106.666667-85.333333zM796.352 769.344a32 32 0 0 1 42.304-6.912l2.666667 1.92 106.666666 85.333333a32 32 0 0 1-37.333333 51.882667l-2.645333-1.92-106.666667-85.333333a32 32 0 0 1-4.992-44.970667z" p-id="2472"></path><path d="M679.018667 78.058667l-373.632 186.944H96a32 32 0 0 0-32 32v463.466666l0.149333 3.093334A32 32 0 0 0 96 792.469333h196.288l387.861333 175.36A32 32 0 0 0 725.333333 938.666667V106.666667a32 32 0 0 0-46.314666-28.608zM661.333333 158.442667v730.645333L312.341333 731.306667l-3.157333-1.237334a32 32 0 0 0-10.026667-1.6H128V329.002667h184.938667a32 32 0 0 0 14.293333-3.370667L661.333333 158.442667z" p-id="2473"></path><path d="M928 512a32 32 0 0 1 3.072 63.850667L928 576h-106.666667a32 32 0 0 1-3.072-63.850667L821.333333 512h106.666667z" p-id="2474"></path></svg>',e.content.firstChild}function s(){let s=e.querySelectorAll(".alert.alert-with-icon>.alert-icon:not(.custom-icon)");for(const e of s)e.append(t());let a=e.querySelectorAll(".alert>.alert-close");for(const e of a)e.addEventListener("click",(()=>{e.parentElement.remove()}))}e.addEventListener?e.addEventListener("DOMContentLoaded",(function t(){e.removeEventListener("DOMContentLoaded",t,!1),s()}),!1):document.attachEvent?document.attachEvent("onreadystatechange",(function e(){"complete"==document.readyState&&(document.detachEvent("onreadystatechange",e),s())})):document.lastChild==document.body&&s()})(document);const p=(()=>{const e={type:"default",duration:3};let t,s=0;const a={defaults:"",info:'<svg t="1620460830700" class="prefix-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="19805" width="18" height="18"><path d="M512 128a384 384 0 1 0 0 768 384 384 0 0 0 0-768z m0 707.669333a323.669333 323.669333 0 1 1 0-647.338666 323.669333 323.669333 0 0 1 0 647.338666z m-0.085333-248.106666c5.034667-12.245333 12.16-29.866667 21.333333-52.906667 9.216-23.04 16.682667-42.496 22.485333-58.368 5.802667-15.872 8.704-26.197333 8.704-30.976 0-8.106667-5.162667-12.16-15.488-12.16-11.861333 0-29.354667 6.656-52.565333 19.968-23.168 13.312-48.213333 31.402667-75.221333 54.272l13.994666 12.8 10.24-8.405333c6.272-6.016 13.824-11.690667 22.656-16.981334 8.832-5.290667 15.146667-7.936 18.944-7.936 5.290667 0 7.936 2.56 7.936 7.765334 0 1.450667-6.954667 19.626667-20.821333 54.485333-13.866667 34.858667-21.674667 54.698667-23.466667 59.434667l-27.989333 64.426666c-7.296 18.688-10.965333 32.085333-10.965333 40.192 0 5.376 2.133333 9.813333 6.442666 13.354667 4.266667 3.541333 9.216 5.290667 14.762667 5.290667 13.866667 0 33.536-7.253333 58.965333-21.674667 25.472-14.464 49.664-30.72 72.533334-48.810667l-14.677334-13.44-5.248 3.285334a72.533333 72.533333 0 0 1-5.674666 3.285333c-24.96 17.834667-42.24 26.752-51.797334 26.752-5.077333 0-7.594667-2.56-7.594666-7.765333 0-4.138667 3.797333-15.957333 11.349333-35.498667 7.552-19.498667 14.592-36.266667 21.162667-50.389333zM560.981333 298.666667c-9.258667 0-17.664 2.517333-25.173333 7.552a55.466667 55.466667 0 0 0-17.493333 18.346666c-4.266667 7.253333-6.314667 14.933333-6.314667 23.04 0 9.301333 3.456 17.706667 10.410667 25.173334a32.981333 32.981333 0 0 0 25.088 11.221333c13.013333 0 24.576-5.546667 34.688-16.554667 10.069333-11.008 15.146667-22.912 15.146666-35.669333a30.208 30.208 0 0 0-10.837333-23.552 37.376 37.376 0 0 0-25.557333-9.557333z" p-id="19806" fill="#2db7f5"></path></svg>',success:'<svg t="1620640616886" class="prefix-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="20843" width="18" height="18"><path d="M512 39.384615C250.092308 39.384615 39.384615 250.092308 39.384615 512s210.707692 472.615385 472.615385 472.615385 472.615385-210.707692 472.615385-472.615385S773.907692 39.384615 512 39.384615z m263.876923 354.461539L474.584615 699.076923c-11.815385 11.815385-31.507692 11.815385-43.323077 0L265.846154 531.692308c-11.815385-11.815385-11.815385-31.507692 0-43.323077l43.323077-43.323077c11.815385-11.815385 31.507692-11.815385 43.323077 0l86.646154 88.615384c7.876923 7.876923 21.661538 7.876923 29.538461 0L689.230769 305.230769c11.815385-11.815385 31.507692-11.815385 43.323077 0l43.323077 43.323077c13.784615 11.815385 13.784615 31.507692 0 45.292308z" p-id="20844" fill="#19be6b"></path></svg>',warning:'<svg t="1620640668390" class="prefix-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="21700" width="18" height="18"><path d="M512 64C264.64 64 64 264.64 64 512c0 247.424 200.64 448 448 448 247.488 0 448-200.576 448-448C960 264.64 759.488 64 512 64zM512 768c-26.432 0-48-21.504-48-48S485.568 672 512 672c26.624 0 48 21.504 48 48S538.624 768 512 768zM560 528C560 554.56 538.624 576 512 576 485.568 576 464 554.56 464 528l0-224C464 277.44 485.568 256 512 256c26.624 0 48 21.44 48 48L560 528z" p-id="21701" fill="#ff9900"></path></svg>',error:'<svg t="1620640709781" class="prefix-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="22548" width="18" height="18"><path d="M512 64.303538c-247.25636 0-447.696462 200.440102-447.696462 447.696462 0 247.254314 200.440102 447.696462 447.696462 447.696462s447.696462-200.440102 447.696462-447.696462S759.25636 64.303538 512 64.303538zM710.491727 665.266709c12.491499 12.491499 12.489452 32.729425-0.002047 45.220924-6.246261 6.246261-14.429641 9.370415-22.611997 9.370415s-16.363689-3.121084-22.60995-9.366322L512 557.222971 358.730221 710.491727c-6.246261 6.246261-14.429641 9.366322-22.611997 9.366322s-16.365736-3.125177-22.611997-9.370415c-12.491499-12.491499-12.491499-32.729425 0-45.220924l153.268756-153.266709L313.50725 358.730221c-12.491499-12.491499-12.489452-32.729425 0.002047-45.220924s32.729425-12.495592 45.220924-0.004093l153.268756 153.268756 153.268756-153.268756c12.491499-12.491499 32.729425-12.487406 45.220924 0.004093s12.493545 32.729425 0.002047 45.220924L557.225017 512 710.491727 665.266709z" p-id="22549" fill="#ed4014"></path></svg>',loading:'<svg t="1620640906619" class="prefix-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="26555" width="18" height="18"><path d="M512 512m-426.666667 0a426.666667 426.666667 0 1 0 853.333334 0 426.666667 426.666667 0 1 0-853.333334 0Z" fill="#959BA7" fill-opacity=".3" p-id="26556"></path><path d="M938.666667 512c0-235.648-191.018667-426.666667-426.666667-426.666667v426.666667h426.666667z" fill="#2db7f5" p-id="26557" data-spm-anchor-id="a313x.7781069.0.i75" class="selected"></path><path d="M512 512m-320 0a320 320 0 1 0 640 0 320 320 0 1 0-640 0Z" fill="#FFFFFF" p-id="26558"></path></svg>',closable:'<svg t="1620705561796" class="suffix-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="28642" width="18" height="18"><path d="M512 426.45429624L683.09140753 255.3628887c24.44162965-24.44162965 61.10407412-24.44162965 85.54570377 0s24.44162965 61.10407412 0 85.54570377L597.54570376 512l171.09140754 171.09140753c24.44162965 24.44162965 24.44162965 61.10407412 0 85.54570377s-61.10407412 24.44162965-85.54570377 0L512 597.54570376 340.90859247 768.6371113c-24.44162965 24.44162965-61.10407412 24.44162965-85.54570377 0-24.44162965-24.44162965-24.44162965-61.10407412 0-85.54570377L426.45429624 512 255.3628887 340.90859247C230.92125905 316.46696281 230.92125905 279.80451835 255.3628887 255.3628887c24.44162965-24.44162965 61.10407412-24.44162965 85.54570377 0L512 426.45429624z" fill="#808695" p-id="28643"></path></svg>'};function n(){return t=t||(()=>{let e=document.getElementById("messages");if(!e){let t=document.createElement("div");t.id="messages",t.setAttribute("messages","messages"),e=document.body.appendChild(t)}return{rootHtml:e,notice(e){return this.rootHtml.appendChild(function(e){const t=document.createElement("template");return e=e.trim(),t.innerHTML=e,t.content.firstChild}(e.html)),this.remove(e),delete e.html,e},remove(e){let t=document.getElementById(e.id);function s(){t.classList.add("notice-fade"),setTimeout((()=>{t.remove()}),350)}e.closable&&(document.getElementById(e.id).getElementsByClassName("suffix-icon")[0].onclick=e=>{s()}),0===e.duration?e.html||s():setTimeout(s,1e3*e.duration)},destroy(){this.rootHtml.classList.add("messages-fade"),setTimeout((()=>{this.rootHtml.remove()}),3e3)}}})(),t}return{info(e){return this.message("info",e)},success(e){return this.message("success",e)},warning(e){return this.message("warning",e)},error(e){return this.message("error",e)},loading(e){return this.message("loading",e)},loadingM(e){return this.message("loadingM",e)},message:(t,i)=>("string"==typeof i&&(i={content:i}),function(t="",i=e.duration,o=e.type,r=function(){},c=!1){const l=a["loadingM"===o?"loading":o],d="loading"===o||"loadingM"===o?" load-loop":"",p="loadingM"===o?'<div class="div-curtain"></div>':"";let h=n();return s++,h.notice({id:`message_key_${s}`,duration:i,html:`\n                <div id="message_key_${s}"  class="notice" style="z-index:${100+s}">\n                    <div class="message ${l?"prefix":""} ${c?"suffix":""} message-${o} ${d} " top="50px">\n                        ${l}\n                        <span>${t}</span>\n                        ${c?a.closable:""}\n                    </div>\n                    ${p}\n                </div>`,content:t,onClose:r,closable:c,type:o})}(i.content,i.duration,t,i.onClose,i.closable)),config(t){t.type&&/^default|info|warning|success|error|loading$/.test(t.type)&&(e.type=t.type),(t.duration||0===t.duration)&&(e.duration=t.duration)},remove(e){n().remove(e)},destroy(){let e=n();t=null,e.destroy()}}})();window.addEventListener("load",(()=>{var t={},s=d(".active-tabbar-item-icon");let a;chrome.runtime.sendMessage({cmd:"popup"},(function(e){t=e,d("a[data-skip='tos']").attr("href",e.tos),d("a[data-skip='privacy']").attr("href",e.privacy),e.descrip||(l(),d(".tabbar-content").addClass("conceal")),h(".tabbar-bottom .tabbar-item[data-id='0']"),e.pp.disabled?d("#switch-adt").addClass("banned"):(d("#switch-adt").removeClass("banned"),e.pp.pause?(f(),v()):b())}));let n=[],i=[],r=-1;const c=(e,s,o)=>{switch(d("section").addClass("conceal"),e){case 0:d("#init-view").removeClass("conceal"),(0==n.length||s>n[n.length-1])&&s>=0&&(s<=5&&d("#init-view .load-progress").text(`${chrome.i18n.getMessage("popupLoadingStart")}(0%)`),r<=s&&0!=a&&(r=s,n.push(s),i.push(o))),a||(a=setInterval((()=>{d("#init-view .load-progress").text(`${i[0]}(${n[0]}%)`),n.length>1&&(n.splice(0,1),i.splice(0,1)),0==n.length&&(clearInterval(a),a=0,n=[],i=[],r=-1)}),600));break;case 1:d("#form-box").removeClass("conceal");break;case 2:t.pp.pause?c(3,chrome.i18n.getMessage("popupAccessAssistantCloseText"),"right-now-recover"):d("#home-view").removeClass("conceal");break;case 3:d("#err-view").removeClass("conceal"),d("#err-view .error-desc").text(s),d("#err-view img").attr("src","../img/icon/"+o+".svg");let e=chrome.i18n.getMessage("popupTryRestartBtnText");switch(o){case"icon-404-color":case"icon-403-color":d("#err-view .err-view-btn").on("click",(()=>{C("#err-view .err-view-btn")})),e=chrome.i18n.getMessage("popupTryRestartBtnText");break;case"icon-no-setting-home":d("#err-view .err-view-btn").on("click",(()=>{chrome.tabs.create({url:"/options.html?type=active"})})),e=chrome.i18n.getMessage("popupGoSettingBtnText");break;case"icon-resteart":d("#err-view .err-view-btn").on("click",(()=>{C("#err-view .err-view-btn")})),e=chrome.i18n.getMessage("popupRightNowRestartBtnText");break;case"right-now-recover":d("#err-view .err-view-btn").on("click",(()=>{chrome.runtime.sendMessage({cmd:"pause",status:!1})})),e=chrome.i18n.getMessage("popupRightNowRecoverBtnText")}d("#err-view button").text(e)}},l=()=>{d(".tabbar-bottom .tabbar-item").removeClass("active-item"),d(".tabbar-bottom .active-tabbar-item-icon").removeClass("active-tabbar-item-icon"),d(".tabbar-bottom .tabbar-tool-item").removeClass("left-tool-item right-tool-item"),d(".tabbar-bottom .item-border-tool").removeClass("item-border-tool"),d(".tabbar-content-item").addClass("conceal");let e=s.getAttr("src");if(-1!=e.indexOf("-active")){let t=e.split("-active");e=t[0]+t[1],s.attr("src",e)}},h=e=>{if(console.log(d(e).getAttr("data-id")),0==d(e).getAttr("data-id")){let e=m();d(".tabbar-bottom .notice .tabbar-main-content").html(e)}if(3==d(e).getAttr("data-id")){let e=u();d(".tabbar-bottom .message .tabbar-main-content").html(e)}1==d(e).getAttr("data-id")&&g()},m=()=>{let e=t?t.descrip:"";return e?`<div class="notice-content">\n                        ${e}\n                    </div>`:`<div class="no-notice">\n                        ${chrome.i18n.getMessage("popupNoDescripText")}\n                    </div>`},g=()=>{d(".tabbar-bottom .home .a-official-website").attr("href",t.home),d(".tabbar-bottom .home .a-help").attr("href",t.help)},u=()=>{let e=t.msgs.reverse(),s="";for(const t of e)s+=`\n            <a href="${t.link}" target="_blank">\n                <div class="message-item">\n                    <div class="message-icon">\n                        <img src="${t.icon?t.icon:"../img/icon-32.png"}" alt="">\n                    </div>\n                    <div class="message-content">\n                        <div class="message-header">\n                            <div class="message-title">${t.title}</div>\n                            \x3c!-- <div class="message-time">${t.time}</div> --\x3e\n                        </div>\n                        <div class="message-body">${t.message}</div>\n                    </div>\n                </div>\n            </a>\n        `;return s},b=()=>{d(".switch .prompt-box").removeClass("warning-box").addClass("success-box"),d(".switch .prompt-box span").text(chrome.i18n.getMessage("popupAccessAssistantOpenText")),d(".switch .prompt-box img").attr("src","../img/icon/icon-small-success.svg"),d(".switch .fwzs-switch").addClass("fwzs-switch-checked"),d(".switch .fwzs-switch-inner").addClass("fwzs-switch-inner-checked").text(chrome.i18n.getMessage("popupOpenText"));let e=-1!=d("#tabbar-item-icon").getAttr("src").indexOf("-active");d("#tabbar-item-icon").attr("src",`../img/icon/device-on${e?"-active":""}.svg`)},f=()=>{d(".switch .prompt-box").removeClass("success-box").addClass("warning-box"),d(".switch .prompt-box span").text(chrome.i18n.getMessage("popupAccessAssistantCloseText")),d(".switch .prompt-box img").attr("src","../img/icon/icon-small-warning.svg"),d(".switch .fwzs-switch").removeClass("fwzs-switch-checked"),d(".switch .fwzs-switch-inner").removeClass("fwzs-switch-inner-checked").text(chrome.i18n.getMessage("popupCloseText"));let e=-1!=d("#tabbar-item-icon").getAttr("src").indexOf("-active");d("#tabbar-item-icon").attr("src",`../img/icon/device-off${e?"-active":""}.svg`)},v=()=>{c(3,chrome.i18n.getMessage("popupAccessAssistantCloseText"),"right-now-recover")};let w=null;const C=e=>{if(w)return;let t=5;d(e).addClass("gray-filter").text(chrome.i18n.getMessage("popupRestartCountdownText1")+t+"s"+chrome.i18n.getMessage("popupRestartCountdownText2")),w=setInterval((()=>{d(e).text(chrome.i18n.getMessage("popupRestartCountdownText1")+--t+"s"+chrome.i18n.getMessage("popupRestartCountdownText2")),0==t&&(clearInterval(w),w=0,chrome.runtime.sendMessage({cmd:"reload"}))}),1e3)},x=()=>{d("#feedback-box").removeClass("popup_feedback"),d("#feedback-box").addClass("fewer_feedback"),document.getElementById("fb-content").value="",d("#feedback-type").attr("data_type","").text(chrome.i18n.getMessage("popupFeedBackDefaultOption")),d("#feedback-box .select-item").removeClass("select-item-selected"),d("#feedback-box .select-item").eq(0).addClass("select-item-selected"),setTimeout((()=>{d("#feedback-box").addClass("conceal")}),350)},R=(e,t)=>{if(!e||"string"!=typeof e)return!1;if(!t||"string"!=typeof t)return!1;let s=e.indexOf(t),a=e[s-1],n=e[s+t.length];return!(-1===s||" "!==a&&void 0!==a||" "!==n&&void 0!==n)},E=(e,t,s)=>{e.stopPropagation(),e.path.forEach((e=>{if(R(e.className,"select")){if(t)try{e.children[0].children[0].innerText=t,d(e.children[0].children[0]).attr("data-type",s),t=!1}catch(e){console.error(e)}-1!=e.className.indexOf("active")?d(e).removeClass("active"):d(e).addClass("active")}}))};d(".tabbar-item").each((e=>{d(e).on("click",(()=>{if(x(),-1!=d(e).getAttr("class").indexOf("active-item"))return l(),d(".tabbar-content").addClass("conceal"),void d("#show-hidden-tabbar").addClass("conceal");l(),d("#show-hidden-tabbar").removeClass("conceal"),d("#show-hidden-tabbar .btn-hidden-tabbar-icon").removeClass("up-img"),d(".tabbar-content").removeClass("conceal"),d(".tabbar-content-item").each(((t,s)=>{d(e).getAttr("data-id")==s&&d(t).removeClass("conceal")})),h(e);let t=d(e).first().first().getAttr("src");t=t.substring(0,t.lastIndexOf(".")),d(e).first().first().attr("src",t+"-active.svg"),s=d(e).first().first(),d(e).addClass("active-item"),d(e).prev().addClass("left-tool-item"),d(e).next().addClass("right-tool-item"),d(e).first().first().addClass("active-tabbar-item-icon"),d(e).last().addClass("item-border-tool"),d(".tabbar-content").removeClass("fewer_tabbar_content"),d(".tabbar-content").addClass("popup_tabbar_content")}))})),d("#show-hidden-tabbar .btn-hidden-tabbar-icon").on("click",(()=>{let e="#show-hidden-tabbar .btn-hidden-tabbar-icon";if(d("#show-hidden-tabbar").removeClass("conceal"),-1!=d(".tabbar-content").getAttr("class").indexOf("conceal")){d(e).removeClass("up-img"),d(".tabbar-content").removeClass("conceal");let t=s.parent().parent(),a=s.getAttr("src");a=a.substring(0,a.lastIndexOf(".")),s.attr("src",a+"-active.svg"),t.addClass("active-item"),t.prev().addClass("left-tool-item"),t.next().addClass("right-tool-item"),t.first().first().addClass("active-tabbar-item-icon"),t.last().addClass("item-border-tool");let n=t.getAttr("data-id");d(".tabbar-content .tabbar-content-item").eq(n).removeClass("conceal"),h(`.tabbar-bottom .tabbar-item[data-id='${n}']`)}else d(e).addClass("up-img"),d("#show-hidden-tabbar").addClass("conceal"),d(".tabbar-content").addClass("conceal"),l()})),d("#switch-adt").on("click",(()=>{chrome.runtime.sendMessage({cmd:"popup"},(e=>{e.pp.disabled||(e.pp.pause?chrome.runtime.sendMessage({cmd:"pause",status:!1}):chrome.runtime.sendMessage({cmd:"pause",status:!0}))}))})),d("#restart-adt").on("click",(()=>{C("#restart-adt")})),d(".home .feedback-btn").on("click",(()=>{d("#feedback-box").removeClass("conceal"),d("#feedback-box").addClass("popup_feedback"),d("#feedback-box").removeClass("fewer_feedback")})),d("#feedback-box .close-fb-btn").on("click",(function(){x()})),d(".select-item").on("click",(e=>{if(e.stopPropagation(),R(e.target.className,"select-item-selected"))return;let t=e.target.parentNode.children;for(let e=0;e<t.length;e++){const s=t[e];d(s).removeClass("select-item-selected")}d(e.target).addClass("select-item-selected"),E(e,d(e.target).text(),d(e.target).getAttr("data-type"))})),d(".select").on("click",E),d("#submit-feedback").on("click",(()=>{let e=d("#feedback-type").getAttr("data-type"),t=document.getElementById("fb-content"),s=t.value;s?chrome.runtime.sendMessage({cmd:"feedback",type:e,content:s},(e=>{1==e.status?(p.success(chrome.i18n.getMessage("popupFeedbackSuccessMssage")),t.value="",x()):p.error(e.error||chrome.i18n.getMessage("popupFeedbackFailureMssage"))})):p.error(chrome.i18n.getMessage("popupFeedbackNullContentMessage"))})),chrome.runtime.onMessage.addListener(((e,s,a)=>("status-change"==e.msg&&(N(),chrome.runtime.sendMessage({cmd:"popup"},(function(e){if(t=e,e.pp.disabled)return f(),void d("#switch-adt").addClass("banned");d("#switch-adt").removeClass("banned"),e.pp.pause?(f(),v()):b()}))),!0)));const N=()=>{chrome.runtime.sendMessage({cmd:"appStatus"},(t=>{switch(t.status){case e.INIT:c(0,5,chrome.i18n.getMessage("popupLoadingInit")),o("#FF0000","...","谷歌访问助手正在启动");break;case e.CONNECTING:c(0,10,chrome.i18n.getMessage("popupLoadingConnection")),o("#FF0000","...","网络连接中");break;case e.LOGINING:c(0,20,chrome.i18n.getMessage("popupLoadingLogining")),o("#FF0000","...","正在登录");break;case e.CHECKING:c(0,40,chrome.i18n.getMessage("popupLoadingChecking")),o("#FF0000","...","正在检查首页");break;case e.PROXYING:c(0,70,chrome.i18n.getMessage("popupLoadingProxying")),o("#FF0000","...","正在获取线路");break;case e.RUNNING:c(2,!0,null),o("#FF0000","","谷歌服务正常访问中");break;case e.CHECKING_HOME_ERROR:c(3,chrome.i18n.getMessage("popupCheckingHomeError"),"icon-no-setting-home"),o("#FF0000","!","您还没有设置主页");break;case e.NEED_LOGIN_ERROR:c(1,null,null),o("#FF0000","?","您需要登录才能使用");break;case e.INIT_CONNECT_ERROR:c(3,chrome.i18n.getMessage("popupInitConnectError"),"icon-404-color"),o("#FF0000","!","网络连接异常，稍后重试");break;case e.INIT_CONFIG_ERROR:c(3,chrome.i18n.getMessage("popupIntConfigError"),"icon-403-color"),o("#FF0000","!","配置文件异常，请联系客服");break;case e.EXPIRE_HOME_ERROR:c(3,chrome.i18n.getMessage("popupExporeHomeError"),"icon-resteart"),o("#FF0000","!","连续使用24小时，需重启检查首页才能生效");break;case e.PROXY_CONFLICT_ERROR:c(3,chrome.i18n.getMessage("badgeProxyConflictError"),"icon-403-color");break;case e.PROXY_BANNED_ERROR:c(3,chrome.i18n.getMessage("badgeProxyBannedError"),"icon-403-color");break;default:o("??")}}))};N(),d("[data-attr-msg]").each((function(e){let t=d(e).getAttr("data-attr"),s=t.split(",");t=s[0];let a=d(e).getAttr("data-attr-msg"),n=a.split(",");a=n[0];for(let t=0;t<s.length;t++)d(e).attr(s[t],chrome.i18n.getMessage(n[t]))})),d("span[data-msg]").each((function(e){let t=d(e).parent();if(!t||!t.value[0])return;t=t.value[0];let s=d(e).parent().html(),a=s.match(/<span data-msg="\w*"><\/span>/g);for(const e of a){let t=/<span data-msg="(.+)"><\/span>/,a=e.match(t)[1],n=chrome.i18n.getMessage(a),i=RegExp(`<span data-msg="${a}"></span>`);s=s.replace(i,n)}d(e).parent().html(s)}))})),window.oncontextmenu=e=>{e.preventDefault()}})();